{"mtime":1373722775,"js":"var CSVReader, ListReader, MetadataReader, list_csv, metadata_csv,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nCSVReader = (function() {\n  function CSVReader(csv_resource) {\n    var col, row;\n\n    this.csv_resource = csv_resource;\n    this.data = (function() {\n      var _i, _len, _ref, _results;\n\n      _ref = (function() {\n        var _j, _len, _ref, _results1;\n\n        _ref = this.csv_resource.split(\"\\n\");\n        _results1 = [];\n        for (_j = 0, _len = _ref.length; _j < _len; _j++) {\n          row = _ref[_j];\n          _results1.push(row);\n        }\n        return _results1;\n      }).call(this);\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        col = _ref[_i];\n        _results.push(col.split(\",\"));\n      }\n      return _results;\n    }).call(this);\n  }\n\n  CSVReader.prototype.rows_size = function() {\n    return this.data.length;\n  };\n\n  CSVReader.prototype.get_row = function(index) {\n    return this.data[index];\n  };\n\n  CSVReader.prototype.get = function(row_index, col_index) {\n    return this.get_row(row_index)[col_index];\n  };\n\n  return CSVReader;\n\n})();\n\nMetadataReader = (function(_super) {\n  __extends(MetadataReader, _super);\n\n  function MetadataReader(csv_resource) {\n    var row, _i, _len, _ref;\n\n    this.csv_resource = csv_resource;\n    MetadataReader.__super__.constructor.call(this, this.csv_resource);\n    this.mapping = {};\n    _ref = this.data;\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      row = _ref[_i];\n      this.mapping[row[1]] = row[0];\n    }\n  }\n\n  MetadataReader.prototype.convert = function(prefix) {\n    return this.mapping[prefix];\n  };\n\n  return MetadataReader;\n\n})(CSVReader);\n\nListReader = (function(_super) {\n  __extends(ListReader, _super);\n\n  function ListReader(csv_resource) {\n    this.csv_resource = csv_resource;\n    ListReader.__super__.constructor.call(this, this.csv_resource);\n    this.list = _.compact(_.flatten(this.data));\n    console.log(this.list);\n  }\n\n  ListReader.prototype.random_get = function() {\n    return this.list[_.random(0, this.list.length - 1)];\n  };\n\n  return ListReader;\n\n})(CSVReader);\n\nlist_csv = \"data/COSCUP2013 All badge code - list.csv\";\n\nmetadata_csv = \"data/COSCUP2013 All badge code - MetaData.csv\";\n\n$.get(list_csv).done(function(list_csv_data) {\n  window.list_csv = new ListReader(list_csv_data);\n  return $.get(metadata_csv).done(function(metadata_csv_data) {\n    return window.metadata_csv = new MetadataReader(metadata_csv_data);\n  });\n});\n\n$(function() {\n  $('.lottery-panel').hide();\n  return $('#lottery').click(function() {\n    var item, meta, people;\n\n    people = window.list_csv.random_get();\n    meta = window.metadata_csv.convert(people[0]);\n    item = $(\"<div class=\\\"lottery-panel\\\"><h2>\" + meta + \"</h2><h1>\" + people + \"</h1></div>\");\n    $(this).after(item);\n    return item.slideDown();\n  });\n});\n"}